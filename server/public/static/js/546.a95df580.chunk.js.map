{"version":3,"file":"static/js/546.a95df580.chunk.js","mappings":"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","sources":["services/userAPI.js","Hooks/useForm.js","container/pages/Admin/Users.jsx"],"sourcesContent":["import { getRequest } from \"./axiosClient\";\r\n\r\nexport const getAllUsers = async (query) => {\r\n  try {\r\n    const response = await getRequest('users', query);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.log('[GET users error]', error);\r\n    return {\r\n      users: [],\r\n      total: 0,\r\n    };\r\n  }\r\n};","import { useState } from 'react'\r\n\r\nconst useForm = (initialValues) => {\r\n    const [values, setValues] = useState(initialValues)\r\n    const handleChange = (event) => {\r\n        const { name, value } = event.target\r\n        setValues({ ...values, [name]: value })\r\n    }\r\n    const resetForm = () => {\r\n        setValues(initialValues)\r\n    }\r\n    return [values, handleChange, resetForm]\r\n}\r\n\r\nexport default useForm","import React, { useEffect, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport moment from \"moment\";\r\nimport {\r\n  Button,\r\n  Col,\r\n  Row,\r\n  Table,\r\n  Tag,\r\n  Space,\r\n  Pagination,\r\n  Input,\r\n  Modal,\r\n  Form,\r\n  InputNumber,\r\n  Tooltip,\r\n  message,\r\n  Layout,\r\n  Badge,\r\n} from \"antd\";\r\nimport { getAllUsers } from \"../../../services/userAPI\";\r\nimport useForm from \"../../../Hooks/useForm\";\r\nimport { increasePlanLimit } from \"../../../services/planAPI\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { updatePageState } from \"../../../redux/user/userSlice\";\r\n\r\nconst { Search } = Input;\r\nconst { Content } = Layout;\r\n\r\nfunction Users() {\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const pageState = useSelector(state => state.user);\r\n\r\n  const [showGiveModal, setShowGiveModal] = useState(false);\r\n  const [users, setUsers] = useState([]);\r\n  const [page, setPage] = useState(pageState.page);\r\n  const [total, setTotal] = useState(pageState.total);\r\n  const [loading, setLoading] = useState(false);\r\n  const [pageSize, setPageSize] = useState(pageState.pageSize);\r\n  const [selectedUser, setSelectedUser] = useState(null);\r\n  const [formData, handleChange] = useForm({});\r\n  const [form] = Form.useForm();\r\n\r\n  const columns = [\r\n    {\r\n      title: \"No\",\r\n      dataIndex: \"_id\",\r\n      key: \"no\",\r\n      width: \"70px\",\r\n      render: (_, row, index) => <>{(page - 1) * pageSize + index + 1} {row.socketId.length > 0 ? <Badge status=\"success\" /> : <Badge status=\"default\" />}</>,\r\n    },\r\n    {\r\n      title: \"Name\",\r\n      dataIndex: \"name\",\r\n      key: \"name\",\r\n    },\r\n    {\r\n      title: \"Email\",\r\n      dataIndex: \"email\",\r\n      key: \"email\",\r\n    },\r\n    // {\r\n    //   title: \"ðŸ›’\",\r\n    //   dataIndex: \"_id\",\r\n    //   key: \"activeSubscriptionId\",\r\n    //   render: (_, row) => {\r\n    //     if (row.activeSubscriptionId?.planId?.price) {\r\n    //       return (\r\n    //         <Tag color=\"#108ee9\">\r\n    //           ${row.activeSubscriptionId?.planId?.price}\r\n    //         </Tag>\r\n    //       );\r\n    //     }\r\n    //   },\r\n    // },\r\n    // {\r\n    //   title: \"Plan\",\r\n    //   dataIndex: \"plan\",\r\n    //   key: \"plan\",\r\n    //   render: (_, row) => {\r\n    //     if (row.plan) {\r\n    //       return (\r\n    //         <>\r\n    //         <Tooltip placement=\"top\" title={\"Property\"}>\r\n    //           <Tag color=\"#108ee9\">{_.property}</Tag>\r\n    //         </Tooltip>\r\n    //         <Tooltip placement=\"top\" title={\"Document\"}>\r\n    //           <Tag color=\"#108ee9\">{_.document}</Tag>\r\n    //         </Tooltip>\r\n    //         {/* <Tooltip placement=\"top\" title={\"Account\"}>\r\n    //           <Tag color=\"#108ee9\">{_.property}</Tag>\r\n    //         </Tooltip> */}\r\n    //         </>\r\n    //       );\r\n    //     }\r\n    //   },\r\n    // },\r\n    {\r\n      title: \"UTM source\",\r\n      dataIndex: \"utm_source\",\r\n      key: \"utm_source\",\r\n    },\r\n    {\r\n      title: \"UTM medium\",\r\n      dataIndex: \"utm_medium\",\r\n      key: \"utm_medium\",\r\n    },\r\n    {\r\n      title: \"UTM capmaign\",\r\n      dataIndex: \"utm_capmaign\",\r\n      key: \"utm_capmaign\",\r\n    },\r\n    {\r\n      title: \"UTM content\",\r\n      dataIndex: \"utm_content\",\r\n      key: \"utm_content\",\r\n    },\r\n    {\r\n      title: \"Date\",\r\n      dataIndex: \"createdAt\",\r\n      key: \"createdAt\",\r\n      render: (_) => {\r\n        return moment(_).format(\"MM/DD/YY hh:mm A\");\r\n      },\r\n    },\r\n    {\r\n      title: \"Projects\",\r\n      dataIndex: \"projects\",\r\n      key: \"projects\",\r\n      render: (_, row) => {\r\n        // console.log(_);\r\n        let isGenerating = _.reduce((accumulator, project) => accumulator + project.resultImages.filter(img => (img.status == 'pending' || img.status == 'processing')).length, 0);\r\n        return <Link to={`/projects/${row._id}`}>\r\n          <Badge status=\"success\" count={isGenerating}>\r\n            <Button size=\"small\">{_?.length || 0}/{_.reduce(\r\n              (accumulator, item) => accumulator + item.resultImages.length,\r\n              0,\r\n            )}</Button>\r\n          </Badge>\r\n        </Link>;\r\n      },\r\n    },\r\n    // {\r\n    //   title: \"Action\",\r\n    //   key: \"_id\",\r\n    //   render: (_, row) => (\r\n    //     <Space size=\"middle\">\r\n    //       <Button\r\n    //         type=\"primary\"\r\n    //         size=\"small\"\r\n    //         onClick={() => {\r\n    //           // if(row.activeSubscriptionId) {\r\n    //             setSelectedUser(row);\r\n    //             form.setFieldValue('property', row.plan?.property || 1);\r\n    //             form.setFieldValue('document', row.plan?.document || 1);\r\n    //             setShowGiveModal(true);\r\n    //           // } else {\r\n    //           //   message.warning(\"No active subscription.\");\r\n    //           // }\r\n    //         }}\r\n    //       >\r\n    //         Give\r\n    //       </Button>\r\n    //       <Link to={`/admin/users/${row._id}/history`}>\r\n    //         <Button type=\"dashed\" danger size=\"small\">View</Button>\r\n    //       </Link>\r\n    //     </Space>\r\n    //   ),\r\n    // },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    getUsers();\r\n  }, [page, pageSize]);\r\n\r\n  const getUsers = (current) => {\r\n    setLoading(true);\r\n    getAllUsers({\r\n      ...formData,\r\n      page: current || page,\r\n      limit: pageSize,\r\n    }).then((data) => {\r\n      setLoading(false);\r\n      setUsers(data.users.map((user) => ({ ...user, key: user._id })));\r\n      setTotal(data.total);\r\n      dispatch(updatePageState({\r\n        total: data.total,\r\n        page,\r\n        pageSize,\r\n      }));\r\n    });\r\n  };\r\n\r\n  const handlePageChange = (pageNumber, pageSize) => {\r\n    setPage(pageNumber);\r\n    setPageSize(pageSize);\r\n  };\r\n\r\n  const onSearch = () => {\r\n    if (page == 1) {\r\n      getUsers(1);\r\n    } else {\r\n      setPage(1);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Content className=\"mx-auto p-2 px-5 my-5\">\r\n      <Row gutter={[16, 16]}>\r\n        <Col sm={12} md={8} lg={6} xl={4}>\r\n          <Search\r\n            placeholder=\"Name...\"\r\n            allowClear\r\n            value={formData.name}\r\n            name=\"name\"\r\n            size=\"large\"\r\n            onChange={handleChange}\r\n            onSearch={onSearch}\r\n          />\r\n        </Col>\r\n        <Col sm={12} md={8} lg={6} xl={4}>\r\n          <Search\r\n            placeholder=\"Email...\"\r\n            allowClear\r\n            value={formData.email}\r\n            name=\"email\"\r\n            size=\"large\"\r\n            onChange={handleChange}\r\n            onSearch={onSearch}\r\n          />\r\n        </Col>\r\n        <Col sm={12} md={8} lg={6} xl={4}>\r\n          <Search\r\n            placeholder=\"Utm Source...\"\r\n            allowClear\r\n            value={formData.utm_source}\r\n            name=\"utm_source\"\r\n            size=\"large\"\r\n            onChange={handleChange}\r\n            onSearch={onSearch}\r\n          />\r\n        </Col>\r\n        <Col sm={12} md={8} lg={6} xl={4}>\r\n          <Search\r\n            placeholder=\"Utm Campaign...\"\r\n            allowClear\r\n            value={formData.utm_campaign}\r\n            name=\"utm_campaign\"\r\n            size=\"large\"\r\n            onChange={handleChange}\r\n            onSearch={onSearch}\r\n          />\r\n        </Col>\r\n        <Col span={24}>\r\n          <Table\r\n            loading={loading}\r\n            columns={columns}\r\n            dataSource={users}\r\n            pagination={false}\r\n          />\r\n          <div className=\"text-right mt-2\">\r\n            <Pagination\r\n              showQuickJumper\r\n              showSizeChanger\r\n              pageSize={pageSize}\r\n              current={page}\r\n              total={total}\r\n              onChange={handlePageChange}\r\n            />\r\n          </div>\r\n        </Col>\r\n      </Row>\r\n      <Modal\r\n        open={showGiveModal}\r\n        title=\"Increase plan\"\r\n        okText=\"Submit\"\r\n        cancelText=\"Cancel\"\r\n        onCancel={() => setShowGiveModal(false)}\r\n        onOk={() => {\r\n          form\r\n            .validateFields()\r\n            .then(async (values) => {\r\n              // console.log(values);\r\n              setLoading(true);\r\n              const res = await increasePlanLimit({\r\n                ...values,\r\n                userId: selectedUser._id,\r\n              });\r\n              message.success('Successfully change plan limit');\r\n              getUsers();\r\n              setShowGiveModal(false);\r\n            })\r\n            .catch((info) => {\r\n              console.log(\"Validate Failed:\", info);\r\n            });\r\n        }}\r\n        okButtonProps={{ loading }}\r\n      >\r\n        <Form form={form} layout=\"vertical\">\r\n          <Form.Item\r\n            name=\"property\"\r\n            label=\"Property\"\r\n            rules={[\r\n              {\r\n                required: true,\r\n                message: \"Please input the count of property\",\r\n              },\r\n            ]}\r\n          >\r\n            <InputNumber className=\"w-full\" size=\"large\" min={1} />\r\n          </Form.Item>\r\n          <Form.Item\r\n            name=\"document\"\r\n            label=\"Document\"\r\n            rules={[\r\n              {\r\n                required: true,\r\n                message: \"Please input the count of document\",\r\n              },\r\n            ]}\r\n          >\r\n            <InputNumber className=\"w-full\" size=\"large\" min={1} />\r\n          </Form.Item>\r\n        </Form>\r\n      </Modal>\r\n    </Content>\r\n  );\r\n}\r\n\r\nexport default Users;\r\n"],"names":["initialValues","values","setValues","useState","event","name","value","target","resetForm","Search","Input","Content","Layout","dispatch","useDispatch","pageState","useSelector","state","user","showGiveModal","setShowGiveModal","users","setUsers","page","setPage","total","setTotal","loading","setLoading","pageSize","setPageSize","selectedUser","setSelectedUser","formData","handleChange","useForm","form","Form","columns","title","dataIndex","key","width","render","_","row","index","_jsxs","_Fragment","children","socketId","length","_jsx","Badge","status","moment","format","isGenerating","reduce","accumulator","project","resultImages","filter","img","Link","to","concat","_id","count","Button","size","item","useEffect","getUsers","current","async","getRequest","query","data","error","console","log","getAllUsers","limit","then","map","updatePageState","onSearch","className","Row","gutter","Col","sm","md","lg","xl","placeholder","allowClear","onChange","email","utm_source","utm_campaign","span","Table","dataSource","pagination","Pagination","showQuickJumper","showSizeChanger","handlePageChange","pageNumber","Modal","open","okText","cancelText","onCancel","onOk","validateFields","increasePlanLimit","userId","message","catch","info","okButtonProps","layout","label","rules","required","InputNumber","min"],"sourceRoot":""}